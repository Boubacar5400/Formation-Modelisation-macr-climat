function [y, T, residual, g1] = dynamic_3(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(8, 1);
  y(19)=(1+x(2))*y(16)*(1-params(5))/params(5)/(1-y(20))/(1-x(4));
  residual(1)=(y(19)*(1+x(5))/(1-x(7)))-(y(22)*(1-params(1))/y(20));
  residual(2)=(y(24))-(y(16)*x(2)+x(3)*y(17)+y(20)*y(19)*(x(5)+x(4))+y(3)*y(21)*x(6)/params(7)+y(22)*x(7)+x(8));
  residual(3)=(y(22))-(y(16)+y(17)+y(24));
  T(1)=x(1)*(y(3)/params(7))^params(1);
  T(2)=y(20)^(1-params(1));
  residual(4)=(y(22))-(T(1)*T(2));
  T(3)=y(16)^params(5);
  T(4)=(1-y(20))^(1-params(5));
  T(5)=T(3)*T(4);
  T(6)=params(5)*T(5)^(-params(3));
  T(7)=y(16)^(params(5)-1);
  T(8)=T(6)*T(7);
  residual(5)=(y(23))-(T(4)*T(8));
  residual(6)=(y(17))-(y(18)-y(3)*(1-params(4))/params(7));
  residual(7)=(y(21)/(1-x(7)))-(params(7)*y(22)*params(1)/y(3));
  T(9)=params(7)^(params(5)*(1-params(3))-1);
  T(10)=T(9)*params(2)*y(38)/(1+y(43));
  residual(8)=(y(23)*(1+x(3))/(1+x(2)))-(T(10)*(y(36)*(1-y(44))+(1-params(4))*(1+y(45))));
  T(11)=getPowerDeriv(T(5),(-params(3)),1);
  T(12)=(-(getPowerDeriv(1-y(20),1-params(5),1)));
if nargout > 3
    g1_v = NaN(29, 1);
g1_v(1)=(-(y(21)*x(6)/params(7)));
g1_v(2)=(-(T(2)*x(1)*1/params(7)*getPowerDeriv(y(3)/params(7),params(1),1)));
g1_v(3)=(1-params(4))/params(7);
g1_v(4)=(-((-(params(7)*y(22)*params(1)))/(y(3)*y(3))));
g1_v(5)=(-((1-params(1))/y(20)));
g1_v(6)=(-x(7));
g1_v(7)=1;
g1_v(8)=1;
g1_v(9)=(-(params(7)*params(1)/y(3)));
g1_v(10)=1;
g1_v(11)=(-1);
g1_v(12)=(-x(3));
g1_v(13)=(-1);
g1_v(14)=1;
g1_v(15)=(1+x(5))*(1+x(2))*y(16)*(1-params(5))/params(5)/((1-y(20))*(1-y(20)))/(1-x(4))/(1-x(7))-(-(y(22)*(1-params(1))))/(y(20)*y(20));
g1_v(16)=(-(y(19)*(x(5)+x(4))+y(20)*(x(5)+x(4))*(1+x(2))*y(16)*(1-params(5))/params(5)/((1-y(20))*(1-y(20)))/(1-x(4))));
g1_v(17)=(-(T(1)*getPowerDeriv(y(20),1-params(1),1)));
g1_v(18)=(-(T(8)*T(12)+T(4)*T(7)*params(5)*T(11)*T(3)*T(12)));
g1_v(19)=(1+x(5))*(1+x(2))*(1-params(5))/params(5)/(1-y(20))/(1-x(4))/(1-x(7));
g1_v(20)=(-(x(2)+y(20)*(x(5)+x(4))*(1+x(2))*(1-params(5))/params(5)/(1-y(20))/(1-x(4))));
g1_v(21)=(-1);
g1_v(22)=(-(T(4)*(T(7)*params(5)*T(4)*getPowerDeriv(y(16),params(5),1)*T(11)+T(6)*getPowerDeriv(y(16),params(5)-1,1))));
g1_v(23)=(-1);
g1_v(24)=(-(y(3)*x(6)/params(7)));
g1_v(25)=1/(1-x(7));
g1_v(26)=1;
g1_v(27)=(1+x(3))/(1+x(2));
g1_v(28)=(-(T(10)*(1-y(44))));
g1_v(29)=(-((y(36)*(1-y(44))+(1-params(4))*(1+y(45)))*T(9)*params(2)/(1+y(43))));
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 8, 24);
end
end
