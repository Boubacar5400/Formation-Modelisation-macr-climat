library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
# ===============================
# 0) Lecture + préparation
# ===============================
df <- read_csv("data_raw/climate_feedback_all_levels.csv")
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
# ===============================
# 0) Lecture des données
# ===============================
df <- read_csv("data_raw/climate_feedback_all_levels.csv")
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
# ===============================
# 0) Lecture + préparation
# ===============================
df <- read_csv("data_raw/climate_feedback_all_levels.csv")
# Scénarios : on garde l'ordre du CSV, baseline en premier
scen_order  <- df %>%
distinct(scenario_label, phi) %>%
arrange(phi) %>%
pull(scenario_label)
df <- df %>%
mutate(
scenario_label = factor(scenario_label, levels = scen_order),
is_baseline    = (scenario_label == scen_order[1])
)
# Labels jolies pour les variables
var_labels_hat <- c(
y = "Production (stationnarisée y)",
d = "Facteur de dommage (d)",
e = "Émissions (stationnarisées, e)",
s = "Stock de GES (stationnarisé, s)",
c = "Consommation (c)",
k = "Capital (k)",
l = "Travail (l)"
)
var_labels_ns <- c(
y = "Production (niveaux, y)",
d = "Facteur de dommage (y)",
e = "Émissions (niveaux, E)",
s = "Stock de GES (niveaux, S)",
c = "Consommation (C)",
k = "Capital (k)",
l = "Travail (l)"
)
# Palette pour les scénarios chocs (tous sauf baseline)
cols_scen <- c(
scen_order[-1]
) |> setNames(c("#D55E00", "#0072B2", "#009E73")[seq_along(scen_order[-1])])
# ===============================
# 1) Niveaux stationnarisés : y, d, e, s
# ===============================
df_hat <- df %>% filter(kind == "hat", variable %in% c("y","d","e","s")) %>%
mutate(variable_label = factor(variable,
levels = names(var_labels_hat),
labels = unname(var_labels_hat)))
p_hat_levels <- ggplot(df_hat, aes(x = t, y = level)) +
# baseline = noir pointillé
geom_line(
data = df_hat %>% filter(is_baseline),
aes(group = scenario_label),
color = "black",
linetype = "dashed",
linewidth = 1
) +
# autres scénarios = couleurs
geom_line(
data = df_hat %>% filter(!is_baseline),
aes(color = scenario_label),
linewidth = 1
) +
scale_color_manual(values = c("#D55E00", "#0072B2", "#009E73"), name = "Scénario") +
facet_wrap(~ variable_label, scales = "free_y") +
labs(
x = "Temps (périodes)",
y = "Niveau (stationnarisé)",
title = "Dommages climatiques : variables stationnarisées"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 14),
legend.position = "bottom"
)
p_hat_levels
ggsave("figures/climate_feedback_stationary.png",
p_hat_levels, width = 12, height = 8, dpi = 300)
# ===============================
# 2) Niveaux non stationnarisés : y, d, e, s
# ===============================
df_ns <- df %>% filter(kind == "ns", variable %in% c("y","d","e","s")) %>%
mutate(variable_label = factor(variable,
levels = names(var_labels_ns),
labels = unname(var_labels_ns)))
library(haven)
G_sabalymemoirefinal01 <- read_dta("C:/Users/DELL/Downloads/G-sabalymemoirefinal01.dta")
View(G_sabalymemoirefinal01)
df <- G_sabalymemoirefinal01
lm(Prod_moy+ Rend_moy +Nombredactifagricole+ Sup_moy  +formation + Plus_5_ans, df)
lm(Prod_moy + Rend_moy +Nombredactifagricole+ Sup_moy  +formation + Plus_5_ans, df)
names(df)
model <- lm(Prod_moy ~ Rend_moy + Nombredactifagricole + Sup_moy + formation + Plus_5_ans,
data = df)
summary(model)
# Transformation des variables qualitatives en facteurs
df$formation <- as.factor(df$formation)
df$Plus_5_ans <- as.factor(df$Plus_5_ans)
# Modèle de régression
model <- lm(Prod_moy ~ Rend_moy + Nombredactifagricole + Sup_moy + formation + Plus_5_ans, data = df)
summary(model)
shapiro.test(residuals(model))
df$log_Prod <- log(df$Prod_moy)
model_log <- lm(log_Prod ~ Rend_moy + Nombredactifagricole + Sup_moy + formation + Plus_5_ans, data=df)
summary(model_log)
shapiro.test(residuals(model_log))
library(MASS)
boxcox(model)
df <- data.frame(df)
# Transformation des variables qualitatives en facteurs
df$formation <- as.factor(df$formation)
df$Plus_5_ans <- as.factor(df$Plus_5_ans)
# Modèle de régression
model <- lm(Prod_moy ~ Rend_moy + Nombredactifagricole + Sup_moy + formation + Plus_5_ans, data = df)
summary(model)
shapiro.test(residuals(model_log))
df$log_Prod <- log(df$Prod_moy)
model_log <- lm(log_Prod ~ Rend_moy + Nombredactifagricole + Sup_moy + formation + Plus_5_ans, data=df)
summary(model_log)
library(MASS)
boxcox(model)
df <- as.data.frame(df)
# Transformation des variables qualitatives en facteurs
df$formation <- as.factor(df$formation)
df$Plus_5_ans <- as.factor(df$Plus_5_ans)
# Modèle de régression
model <- lm(Prod_moy ~ Rend_moy + Nombredactifagricole + Sup_moy + formation + Plus_5_ans, data = df)
summary(model)
shapiro.test(residuals(model_log))
df$log_Prod <- log(df$Prod_moy)
model_log <- lm(log_Prod ~ Rend_moy + Nombredactifagricole + Sup_moy + formation + Plus_5_ans, data=df)
summary(model_log)
library(MASS)
boxcox(model)
names(df)
